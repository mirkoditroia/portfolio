<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Performance Test - Portfolio VFXULO</title>
    <style>
        body {
            font-family: 'Montserrat', Arial, sans-serif;
            background: #0a0a0a;
            color: #fff;
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .test-section {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid rgba(64, 224, 208, 0.2);
        }
        
        .metric {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .metric:last-child {
            border-bottom: none;
        }
        
        .metric-label {
            font-weight: 600;
            color: #40e0d0;
        }
        
        .metric-value {
            font-family: monospace;
            background: rgba(0,0,0,0.3);
            padding: 4px 8px;
            border-radius: 4px;
        }
        
        .status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .status.success {
            background: #28a745;
            color: white;
        }
        
        .status.warning {
            background: #ffc107;
            color: black;
        }
        
        .status.error {
            background: #dc3545;
            color: white;
        }
        
        .canvas-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .test-canvas {
            width: 100%;
            height: 150px;
            border-radius: 8px;
            background: #1a1a2e;
            border: 2px solid rgba(64, 224, 208, 0.3);
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #40e0d0, #ff0080);
            transition: width 0.3s ease;
        }
        
        .test-button {
            background: linear-gradient(135deg, #40e0d0, #ff0080);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            margin: 10px 5px;
            transition: transform 0.2s;
        }
        
        .test-button:hover {
            transform: translateY(-2px);
        }
        
        .log {
            background: rgba(0,0,0,0.5);
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            max-height: 300px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }
        
        .log-entry {
            margin: 5px 0;
            padding: 5px;
            border-radius: 4px;
        }
        
        .log-entry.info { background: rgba(64, 224, 208, 0.1); }
        .log-entry.warn { background: rgba(255, 193, 7, 0.1); }
        .log-entry.error { background: rgba(220, 53, 69, 0.1); }
        
        h1, h2 {
            color: #40e0d0;
            margin-bottom: 20px;
        }
        
        .performance-score {
            font-size: 3em;
            font-weight: bold;
            text-align: center;
            margin: 20px 0;
            background: linear-gradient(135deg, #40e0d0, #ff0080);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ Performance Test - Portfolio VFXULO</h1>
        
        <div class="test-section">
            <h2>üìä Metriche Performance</h2>
            <div class="metric">
                <span class="metric-label">First Paint:</span>
                <span class="metric-value" id="firstPaint">Misurando...</span>
            </div>
            <div class="metric">
                <span class="metric-label">First Contentful Paint:</span>
                <span class="metric-value" id="firstContentfulPaint">Misurando...</span>
            </div>
            <div class="metric">
                <span class="metric-label">Largest Contentful Paint:</span>
                <span class="metric-value" id="largestContentfulPaint">Misurando...</span>
            </div>
            <div class="metric">
                <span class="metric-label">Time to Interactive:</span>
                <span class="metric-value" id="timeToInteractive">Misurando...</span>
            </div>
            <div class="metric">
                <span class="metric-label">Total Blocking Time:</span>
                <span class="metric-value" id="totalBlockingTime">Misurando...</span>
            </div>
            <div class="metric">
                <span class="metric-label">Cumulative Layout Shift:</span>
                <span class="metric-value" id="cumulativeLayoutShift">Misurando...</span>
            </div>
        </div>
        
        <div class="test-section">
            <h2>üéØ Performance Score</h2>
            <div class="performance-score" id="performanceScore">--</div>
            <div class="progress-bar">
                <div class="progress-fill" id="performanceBar" style="width: 0%"></div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>üé® Canvas Loading Test</h2>
            <button class="test-button" onclick="testCanvasLoading()">Test Canvas Loading</button>
            <button class="test-button" onclick="testLazyLoading()">Test Lazy Loading</button>
            <button class="test-button" onclick="clearCanvasTest()">Clear Test</button>
            
            <div class="canvas-grid" id="canvasGrid">
                <!-- Canvas di test verranno generati qui -->
            </div>
        </div>
        
        <div class="test-section">
            <h2>üì± Memory Usage</h2>
            <div class="metric">
                <span class="metric-label">Heap Size:</span>
                <span class="metric-value" id="heapSize">Misurando...</span>
            </div>
            <div class="metric">
                <span class="metric-label">Memory Usage:</span>
                <span class="metric-value" id="memoryUsage">Misurando...</span>
            </div>
            <div class="metric">
                <span class="metric-label">Canvas Count:</span>
                <span class="metric-value" id="canvasCount">0</span>
            </div>
        </div>
        
        <div class="test-section">
            <h2>üîç Network Performance</h2>
            <div class="metric">
                <span class="metric-label">Connection Type:</span>
                <span class="metric-value" id="connectionType">Misurando...</span>
            </div>
            <div class="metric">
                <span class="metric-label">Effective Type:</span>
                <span class="metric-value" id="effectiveType">Misurando...</span>
            </div>
            <div class="metric">
                <span class="metric-label">Downlink:</span>
                <span class="metric-value" id="downlink">Misurando...</span>
            </div>
        </div>
        
        <div class="test-section">
            <h2>üìù Performance Log</h2>
            <div class="log" id="performanceLog">
                <div class="log-entry info">üöÄ Performance test inizializzato...</div>
            </div>
        </div>
    </div>

    <script>
        // Performance monitoring
        let performanceMetrics = {};
        let canvasTestCount = 0;
        
        // Log function
        function log(message, type = 'info') {
            const logContainer = document.getElementById('performanceLog');
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logContainer.appendChild(entry);
            logContainer.scrollTop = logContainer.scrollHeight;
        }
        
        // Measure performance metrics
        function measurePerformance() {
            // First Paint
            const paintEntries = performance.getEntriesByType('paint');
            const firstPaint = paintEntries.find(entry => entry.name === 'first-paint');
            if (firstPaint) {
                performanceMetrics.firstPaint = firstPaint.startTime;
                document.getElementById('firstPaint').textContent = `${Math.round(firstPaint.startTime)}ms`;
            }
            
            // First Contentful Paint
            const firstContentfulPaint = paintEntries.find(entry => entry.name === 'first-contentful-paint');
            if (firstContentfulPaint) {
                performanceMetrics.firstContentfulPaint = firstContentfulPaint.startTime;
                document.getElementById('firstContentfulPaint').textContent = `${Math.round(firstContentfulPaint.startTime)}ms`;
            }
            
            // Largest Contentful Paint
            const lcpEntries = performance.getEntriesByType('largest-contentful-paint');
            if (lcpEntries.length > 0) {
                const lcp = lcpEntries[lcpEntries.length - 1];
                performanceMetrics.largestContentfulPaint = lcp.startTime;
                document.getElementById('largestContentfulPaint').textContent = `${Math.round(lcp.startTime)}ms`;
            }
            
            // Calculate performance score
            calculatePerformanceScore();
        }
        
        // Calculate performance score
        function calculatePerformanceScore() {
            let score = 100;
            const warnings = [];
            
            if (performanceMetrics.firstPaint > 1000) {
                score -= 20;
                warnings.push('First Paint troppo lento');
            }
            
            if (performanceMetrics.firstContentfulPaint > 1500) {
                score -= 25;
                warnings.push('First Contentful Paint troppo lento');
            }
            
            if (performanceMetrics.largestContentfulPaint > 2500) {
                score -= 30;
                warnings.push('Largest Contentful Paint troppo lento');
            }
            
            score = Math.max(0, score);
            
            document.getElementById('performanceScore').textContent = score;
            document.getElementById('performanceBar').style.width = `${score}%`;
            
            if (score >= 90) {
                document.getElementById('performanceScore').style.color = '#28a745';
            } else if (score >= 70) {
                document.getElementById('performanceScore').style.color = '#ffc107';
            } else {
                document.getElementById('performanceScore').style.color = '#dc3545';
            }
            
            log(`Performance Score: ${score}/100`, score >= 90 ? 'info' : score >= 70 ? 'warn' : 'error');
            warnings.forEach(warning => log(warning, 'warn'));
        }
        
        // Monitor memory usage
        function monitorMemory() {
            if ('memory' in performance) {
                const memory = performance.memory;
                const heapSizeMB = Math.round(memory.usedJSHeapSize / 1024 / 1024);
                const totalHeapMB = Math.round(memory.totalJSHeapSize / 1024 / 1024);
                
                document.getElementById('heapSize').textContent = `${heapSizeMB}MB / ${totalHeapMB}MB`;
                document.getElementById('memoryUsage').textContent = `${Math.round((memory.usedJSHeapSize / memory.totalJSHeapSize) * 100)}%`;
            }
            
            const canvasCount = document.querySelectorAll('canvas').length;
            document.getElementById('canvasCount').textContent = canvasCount;
        }
        
        // Monitor network
        function monitorNetwork() {
            if ('connection' in navigator) {
                const connection = navigator.connection;
                document.getElementById('connectionType').textContent = connection.effectiveType || 'Unknown';
                document.getElementById('effectiveType').textContent = connection.effectiveType || 'Unknown';
                document.getElementById('downlink').textContent = `${connection.downlink} Mbps`;
            }
        }
        
        // Test canvas loading
        function testCanvasLoading() {
            log('üé® Iniziando test caricamento canvas...', 'info');
            
            const grid = document.getElementById('canvasGrid');
            const startTime = performance.now();
            
            // Crea 10 canvas di test
            for (let i = 0; i < 10; i++) {
                const canvas = document.createElement('canvas');
                canvas.className = 'test-canvas';
                canvas.width = 200;
                canvas.height = 150;
                
                const ctx = canvas.getContext('2d');
                
                // Simula contenuto canvas
                setTimeout(() => {
                    ctx.fillStyle = `hsl(${i * 36}, 70%, 50%)`;
                    ctx.fillRect(0, 0, 200, 150);
                    ctx.fillStyle = 'white';
                    ctx.font = '16px Arial';
                    ctx.fillText(`Canvas ${i + 1}`, 10, 30);
                    
                    canvasTestCount++;
                    log(`‚úÖ Canvas ${i + 1} caricato`, 'info');
                    
                    if (canvasTestCount === 10) {
                        const endTime = performance.now();
                        const duration = endTime - startTime;
                        log(`üéâ Test completato in ${Math.round(duration)}ms`, 'info');
                        monitorMemory();
                    }
                }, i * 100); // Simula caricamento progressivo
                
                grid.appendChild(canvas);
            }
        }
        
        // Test lazy loading
        function testLazyLoading() {
            log('üëÅÔ∏è Testando lazy loading...', 'info');
            
            // Simula Intersection Observer
            const canvases = document.querySelectorAll('.test-canvas');
            let loadedCount = 0;
            
            canvases.forEach((canvas, index) => {
                setTimeout(() => {
                    const ctx = canvas.getContext('2d');
                    ctx.fillStyle = `hsl(${index * 36}, 70%, 30%)`;
                    ctx.fillRect(0, 0, 200, 150);
                    ctx.fillStyle = 'white';
                    ctx.font = '16px Arial';
                    ctx.fillText(`Lazy ${index + 1}`, 10, 30);
                    
                    loadedCount++;
                    log(`üëÅÔ∏è Canvas ${index + 1} lazy loaded`, 'info');
                    
                    if (loadedCount === canvases.length) {
                        log('‚úÖ Lazy loading test completato', 'info');
                        monitorMemory();
                    }
                }, index * 200);
            });
        }
        
        // Clear canvas test
        function clearCanvasTest() {
            document.getElementById('canvasGrid').innerHTML = '';
            canvasTestCount = 0;
            log('üóëÔ∏è Test canvas puliti', 'info');
            monitorMemory();
        }
        
        // Initialize monitoring
        window.addEventListener('load', () => {
            log('üöÄ Pagina caricata, iniziando monitoraggio...', 'info');
            
            // Measure initial performance
            setTimeout(measurePerformance, 100);
            
            // Monitor memory and network
            setInterval(monitorMemory, 2000);
            setInterval(monitorNetwork, 5000);
            
            // Initial measurements
            monitorMemory();
            monitorNetwork();
        });
        
        // Monitor for performance entries
        const observer = new PerformanceObserver((list) => {
            for (const entry of list.getEntries()) {
                if (entry.entryType === 'largest-contentful-paint') {
                    performanceMetrics.largestContentfulPaint = entry.startTime;
                    document.getElementById('largestContentfulPaint').textContent = `${Math.round(entry.startTime)}ms`;
                    calculatePerformanceScore();
                }
            }
        });
        
        observer.observe({ entryTypes: ['largest-contentful-paint'] });
        
        // Monitor for layout shifts
        const layoutObserver = new PerformanceObserver((list) => {
            let totalShift = 0;
            for (const entry of list.getEntries()) {
                totalShift += entry.value;
            }
            performanceMetrics.cumulativeLayoutShift = totalShift;
            document.getElementById('cumulativeLayoutShift').textContent = totalShift.toFixed(3);
        });
        
        layoutObserver.observe({ entryTypes: ['layout-shift'] });
    </script>
</body>
</html> 